service_id: AmazonRDS
version: "1.0.0"
metadata:
  service_id: AmazonRDS
  display_name: Amazon RDS
  description: Managed relational database service supporting MySQL, PostgreSQL, Oracle, SQL Server
  category: Database
  icon_url: https://aws.amazon.com/rds/icon.png
  tags:
    - database
    - relational
    - managed

dependencies:
  mandatory:
    - service: VPC
      reason: RDS instances must be launched in a VPC
      
    - service: EBS
      reason: RDS uses EBS volumes for database storage
      
  conditional:
    - service: RDS_MultiAZ
      condition: multi_az == true
      reason: Multi-AZ deployment for high availability
      
  implicit:
    - service: DataTransfer_CrossAZ
      condition: multi_az == true
      reason: Multi-AZ replication incurs cross-AZ data transfer costs
      cost_impact:
        driver: cross_az_replication
        estimated_range: [10, 500]
        
    - service: CloudWatchMetrics
      reason: RDS automatically publishes metrics to CloudWatch
      cost_impact:
        driver: enhanced_monitoring
        estimated_range: [1, 20]
        
    - service: RDS_Backups
      reason: Automated backups enabled by default
      cost_impact:
        driver: backup_storage
        estimated_range: [5, 200]

validation_rules:
  - id: rds_multi_az_production
    type: warning
    condition: multi_az == false && environment == "production"
    message: "Multi-AZ not enabled for production database"
    recommendation: "Enable Multi-AZ for high availability in production"
    
  - id: rds_backup_retention
    type: warning
    condition: backup_retention_days < 7
    message: "Backup retention less than 7 days"
    recommendation: "Consider increasing backup retention for disaster recovery"
    
  - id: rds_instance_size
    type: info
    condition: instance_class.startswith("db.t")
    message: "Using burstable instance type (T-series)"
    recommendation: "Consider M/R-series for consistent performance workloads"
    
  - id: rds_storage_autoscaling
    type: warning
    condition: storage_autoscaling == false && storage_type == "gp3"
    message: "Storage autoscaling disabled"
    recommendation: "Enable storage autoscaling to prevent out-of-space issues"
