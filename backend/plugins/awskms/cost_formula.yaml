service: awskms
version: "1.0.0"

inputs:
  - name: customer_managed_keys
    type: integer
    required: true
    default: 1
    description: "Number of customer managed keys"
  - name: requests_per_month
    type: integer
    required: true
    default: 100000
    description: "Number of API requests per month"

calculation_steps:
  - id: key_cost
    description: "Customer managed key cost"
    formula: "customer_managed_keys * 1.00"
    output: key_cost
  - id: request_cost
    description: "API request cost"
    formula: |
      if requests_per_month <= 20000:
        0
      else:
        (requests_per_month - 20000) * 0.00000300
    output: request_cost

total_formula: "key_cost + request_cost"

assumptions:
  - "Customer managed key: $1.00 per month"
  - "First 20,000 requests free per month"
  - "Requests: $0.03 per 10,000 requests after free tier"
  - "AWS managed keys: free"
  - "Pricing based on us-east-1"

pricing_sources:
  - name: "AWS KMS Pricing"
    url: "https://aws.amazon.com/kms/pricing/"
    last_updated: "2024-01-01"
