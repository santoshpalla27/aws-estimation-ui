service: AmazonCloudWatch
version: "1.0.0"

inputs:
  - name: custom_metrics_count
    type: integer
    required: false
    default: 0
    description: "Number of custom metrics"
    
  - name: log_ingestion_gb
    type: number
    required: true
    description: "Log data ingested (GB/month)"
    
  - name: log_storage_gb
    type: number
    required: true
    description: "Log data stored (GB/month)"
    
  - name: alarms_count
    type: integer
    required: false
    default: 0
    description: "Number of alarms"

calculation_steps:
  - id: metrics_cost
    description: "Custom metrics cost"
    formula: "custom_metrics_count * 0.30"  # $0.30 per metric/month
    output: metrics_cost
    
  - id: log_ingestion_cost
    description: "Log ingestion cost"
    formula: "log_ingestion_gb * 0.50"  # $0.50 per GB ingested
    output: ingestion_cost
    
  - id: log_storage_cost
    description: "Log storage cost"
    formula: "log_storage_gb * 0.03"  # $0.03 per GB stored
    output: storage_cost
    
  - id: alarms_cost
    description: "Alarms cost"
    formula: |
      if alarms_count <= 10:
        0  # First 10 alarms free
      else:
        (alarms_count - 10) * 0.10  # $0.10 per alarm
    output: alarms_cost

total_formula: "metrics_cost + ingestion_cost + storage_cost + alarms_cost"

assumptions:
  - "Pricing based on us-east-1"
  - "First 10 alarms are free"
  - "Standard metrics from AWS services are free"

pricing_sources:
  - name: "Amazon CloudWatch Pricing"
    url: "https://aws.amazon.com/cloudwatch/pricing/"
    last_updated: "2024-01-01"
