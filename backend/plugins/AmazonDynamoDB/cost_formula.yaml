service: AmazonDynamoDB
version: "1.0.0"

inputs:
  - name: capacity_mode
    type: string
    required: true
    description: "Capacity mode (PROVISIONED or ON_DEMAND)"
    
  - name: read_capacity_units
    type: integer
    required: false
    description: "Provisioned RCUs (for PROVISIONED mode)"
    
  - name: write_capacity_units
    type: integer
    required: false
    description: "Provisioned WCUs (for PROVISIONED mode)"
    
  - name: storage_gb
    type: number
    required: true
    description: "Data storage in GB"
    
  - name: read_requests_millions
    type: number
    required: false
    description: "Read requests per month (millions, for ON_DEMAND)"
    
  - name: write_requests_millions
    type: number
    required: false
    description: "Write requests per month (millions, for ON_DEMAND)"

calculation_steps:
  - id: capacity_cost
    description: "Capacity cost based on mode"
    formula: |
      if capacity_mode == "PROVISIONED":
        rcu_cost = read_capacity_units * 730 * 0.00013  # $0.00013 per RCU-hour
        wcu_cost = write_capacity_units * 730 * 0.00065  # $0.00065 per WCU-hour
        rcu_cost + wcu_cost
      else:
        read_cost = read_requests_millions * 0.25  # $0.25 per million reads
        write_cost = write_requests_millions * 1.25  # $1.25 per million writes
        read_cost + write_cost
    output: capacity_cost
    
  - id: storage_cost
    description: "Storage cost"
    formula: "storage_gb * 0.25"  # $0.25 per GB-month
    output: storage_cost

total_formula: "capacity_cost + storage_cost"

assumptions:
  - "Pricing based on us-east-1"
  - "Standard table class (not Infrequent Access)"
  - "No global tables or backups"

pricing_sources:
  - name: "Amazon DynamoDB Pricing"
    url: "https://aws.amazon.com/dynamodb/pricing/"
    last_updated: "2024-01-01"
