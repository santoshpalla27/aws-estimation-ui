service: AmazonEKS
version: "1.0.0"

inputs:
  - name: cluster_count
    type: integer
    required: true
    default: 1
    description: "Number of EKS clusters"
  - name: node_group_type
    type: string
    required: true
    default: "Fargate"
    description: "Node group type (EC2, Fargate, or Both)"
  - name: fargate_vcpu_hours
    type: number
    required: false
    default: 0
    description: "Fargate vCPU hours per month"
  - name: fargate_gb_hours
    type: number
    required: false
    default: 0
    description: "Fargate GB memory hours per month"

calculation_steps:
  - id: cluster_cost
    description: "EKS cluster cost"
    formula: "cluster_count * 0.10 * 730"
    output: cluster_cost
  - id: fargate_vcpu_cost
    description: "Fargate vCPU cost"
    formula: |
      if node_group_type in ['Fargate', 'Both']:
        fargate_vcpu_hours * 0.04048
      else:
        0
    output: vcpu_cost
  - id: fargate_memory_cost
    description: "Fargate memory cost"
    formula: |
      if node_group_type in ['Fargate', 'Both']:
        fargate_gb_hours * 0.004445
      else:
        0
    output: memory_cost

total_formula: "cluster_cost + vcpu_cost + memory_cost"

assumptions:
  - "EKS cluster: $0.10 per hour ($73 per month)"
  - "Fargate: $0.04048 per vCPU hour, $0.004445 per GB hour"
  - "EC2 nodes: pay for EC2 instances separately"
  - "Pricing based on us-east-1"

pricing_sources:
  - name: "Amazon EKS Pricing"
    url: "https://aws.amazon.com/eks/pricing/"
    last_updated: "2024-01-01"
