service: AWSELB
version: "2.0.0"

inputs:
  - name: load_balancer_type
    type: string
    required: true
    default: "Network"
    description: "Load balancer type (Network, Classic, or Application)"
  - name: number_of_lbs
    type: integer
    required: true
    default: 1
    description: "Number of load balancers"
  - name: data_processed_gb
    type: number
    required: true
    default: 1000
    description: "Data processed (GB/month)"

calculation_steps:
  - id: lb_hour_cost
    description: "Load balancer hour cost"
    formula: |
      number_of_lbs * pricing.constants.hours_per_month * (
        pricing.network_lb.per_hour if load_balancer_type == 'Network' else
        pricing.application_lb.per_hour if load_balancer_type == 'Application' else
        pricing.classic_lb.per_hour
      )
    output: lb_cost
    pricing_keys:
      - network_lb.per_hour
      - application_lb.per_hour
      - classic_lb.per_hour
      - constants.hours_per_month
      
  - id: data_cost
    description: "Data processed cost (NLB only)"
    formula: |
      if load_balancer_type == 'Network':
        data_processed_gb * pricing.network_lb.per_gb_processed
      else:
        0
    output: data_cost
    pricing_keys:
      - network_lb.per_gb_processed

total_formula: "lb_cost + data_cost"

assumptions:
  - "Network LB: charged per hour + per GB processed"
  - "Application LB: charged per hour + LCU"
  - "Classic LB: charged per hour only"
  - "LCU charges for ALB not included (simplified)"

pricing_sources:
  - name: "Elastic Load Balancing Pricing"
    url: "https://aws.amazon.com/elasticloadbalancing/pricing/"
    last_updated: "2024-12-15"
