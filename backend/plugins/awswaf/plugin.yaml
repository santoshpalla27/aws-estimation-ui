service_id: awswaf
version: "1.0.0"
category: Security

metadata:
  service_id: awswaf
  display_name: AWS WAF
  description: Web application firewall to protect against common web exploits
  category: Security
  icon_url: ""
  tags: [firewall, security, web, ddos]

dependencies:
  mandatory: []
  conditional:
    - service: AmazonCloudFront
      condition: "resource_type == 'CloudFront'"
      reason: "WAF protecting CloudFront distribution"
    - service: AWSELB
      condition: "resource_type == 'ALB'"
      reason: "WAF protecting Application Load Balancer"
  implicit: []

validation_rules:
  - field: web_acls
    rule: "web_acls > 0"
    message: "Must have at least one Web ACL"
    severity: error
